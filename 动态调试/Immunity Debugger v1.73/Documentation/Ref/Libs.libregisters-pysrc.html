<?xml version="1.0" encoding="ascii"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
          "DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
  <title>Libs.libregisters</title>
  <link rel="stylesheet" href="epydoc.css" type="text/css" />
  <script type="text/javascript" src="epydoc.js"></script>
</head>

<body bgcolor="white" text="black" link="blue" vlink="#204080"
      alink="#204080">
<!-- ==================== NAVIGATION BAR ==================== -->
<table class="navbar" border="0" width="100%" cellpadding="0"
       bgcolor="#a0c0ff" cellspacing="0">
  <tr valign="middle">

  <!-- Tree link -->
      <th>&nbsp;&nbsp;&nbsp;<a
        href="module-tree.html">Trees</a>&nbsp;&nbsp;&nbsp;</th>

  <!-- Index link -->
      <th>&nbsp;&nbsp;&nbsp;<a
        href="identifier-index.html">Indices</a>&nbsp;&nbsp;&nbsp;</th>

  <!-- Help link -->
      <th>&nbsp;&nbsp;&nbsp;<a
        href="help.html">Help</a>&nbsp;&nbsp;&nbsp;</th>

  <!-- Project homepage -->
      <th class="navbar" align="right" width="100%">
        <table border="0" cellpadding="0" cellspacing="0">
          <tr><th class="navbar" align="center"
            >Immunity Debugger API Reference</th>
          </tr></table></th>
  </tr>
</table>
<table width="100%" cellpadding="0" cellspacing="0">
  <tr valign="top">
    <td width="100%">
      <span class="breadcrumbs">
        Package&nbsp;Libs ::
        Module&nbsp;libregisters
      </span>
    </td>
    <td>
      <table cellpadding="0" cellspacing="0">
        <!-- hide/show private -->
        <tr><td align="right"><span class="options">[<a href="javascript: void(0);" class="privatelink"
    onclick="toggle_private();">hide private</a>]</span></td></tr>
        <tr><td align="right"><span class="options"
            >[<a href="frames.html" target="_top">frames</a
            >]&nbsp;|&nbsp;<a href="Libs.libregisters-pysrc.html"
            target="_top">no&nbsp;frames</a>]</span></td></tr>
      </table>
    </td>
  </tr>
</table>
<h1 class="epydoc">Source Code for <a href="Libs.libregisters-module.html">Module Libs.libregisters</a></h1>
<pre class="py-src">
<span class="py-lineno">  1</span>  <span class="py-line"><span class="py-comment">#!/usr/bin/env python</span> </span>
<span class="py-lineno">  2</span>  <span class="py-line"><span class="py-comment"></span> </span>
<span class="py-lineno">  3</span>  <span class="py-line"><span class="py-docstring">"""</span> </span>
<span class="py-lineno">  4</span>  <span class="py-line"><span class="py-docstring">(c) Immunity, Inc. 2004-2007</span> </span>
<span class="py-lineno">  5</span>  <span class="py-line"><span class="py-docstring"></span> </span>
<span class="py-lineno">  6</span>  <span class="py-line"><span class="py-docstring"></span> </span>
<span class="py-lineno">  7</span>  <span class="py-line"><span class="py-docstring">U{Immunity Inc.&lt;http://www.immunityinc.com&gt;}</span> </span>
<span class="py-lineno">  8</span>  <span class="py-line"><span class="py-docstring"></span> </span>
<span class="py-lineno">  9</span>  <span class="py-line"><span class="py-docstring"></span> </span>
<span class="py-lineno"> 10</span>  <span class="py-line"><span class="py-docstring">"""</span> </span>
<span class="py-lineno"> 11</span>  <span class="py-line"><span class="py-comment">#</span> </span>
<span class="py-lineno"> 12</span>  <span class="py-line"><span class="py-comment"></span><span id="link-0" class="py-name"><a title="Libs.debugtypes.__version__
Libs.graphclass.__version__
Libs.libregisters.__version__" class="py-name" href="#" onclick="doclink('link-0', '__version__', 'Variable Libs.debugtypes.__version__=Libs.debugtypes-module.html#__version__,Variable Libs.graphclass.__version__=Libs.graphclass-module.html#__version__,Variable Libs.libregisters.__version__=Libs.libregisters-module.html#__version__'); return false;">__version__</a></span></span> <span class="py-op">=</span> <span class="py-string">'1.0'</span> </span>
<span class="py-lineno"> 13</span>  <span class="py-line"> </span>
<span class="py-lineno"> 14</span>  <span class="py-line"><span class="py-keyword">import</span> <span class="py-name">_winreg</span> </span>
<span class="py-lineno"> 15</span>  <span class="py-line"> </span>
<span class="py-lineno"> 16</span>  <span class="py-line"><span class="py-comment"># Documentation</span> </span>
<span class="py-lineno"> 17</span>  <span class="py-line"><span class="py-comment"></span><span class="py-comment">#  http://msdn2.microsoft.com/en-us/library/cc265944.aspx</span> </span>
<span class="py-lineno"> 18</span>  <span class="py-line"><span class="py-comment"></span><span class="py-comment">#  http://msdn2.microsoft.com/en-us/library/cc265944.aspx</span> </span>
<span class="py-lineno"> 19</span>  <span class="py-line"><span class="py-comment"></span> </span>
<span class="py-lineno"> 20</span>  <span class="py-line"> </span>
<span class="py-lineno"> 21</span>  <span class="py-line"><span class="py-comment">#Systemwide settings ("Registry")       HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\Session Manager\GlobalFlag</span> </span>
<span class="py-lineno"> 22</span>  <span class="py-line"><span class="py-comment"></span><span class="py-comment">#Program-specific settings ("Image file") for all users of the computer.        HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Image File Execution Options\ImageFileName\GlobalFlag</span> </span>
<span class="py-lineno"> 23</span>  <span class="py-line"><span class="py-comment"></span><span class="py-comment">#Program-specific settings ("Image file") for a specified user of the computer.         HKEY_USERS\SID\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Image File Execution Options\ImageFileName\GlobalFlag</span> </span>
<span class="py-lineno"> 24</span>  <span class="py-line"><span class="py-comment"></span><span class="py-comment">#Page heap options for an image file for all users of the computer      HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Image File Execution Options\ImageFileName\PageHeapFlags</span> </span>
<span class="py-lineno"> 25</span>  <span class="py-line"><span class="py-comment"></span><span class="py-comment">#Page heap options for an image file for a specified user of the computer       HKEY_USERS\SID\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Image File Execution Options\ImageFileName\PageHeapFlags</span> </span>
<span class="py-lineno"> 26</span>  <span class="py-line"><span class="py-comment"></span><span class="py-comment">#User mode stack trace database size (tracedb)  HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Image File Execution Options\ImageFileName\StackTraceDatabaseSizeInMbz</span> </span>
<span class="py-lineno"> 27</span>  <span class="py-line"><span class="py-comment"></span> </span>
<span class="py-lineno"> 28</span>  <span class="py-line"><span id="link-1" class="py-name"><a title="Libs.libregisters.GFlagsTags" class="py-name" href="#" onclick="doclink('link-1', 'GFlagsTags', 'Variable Libs.libregisters.GFlagsTags=Libs.libregisters-module.html#GFlagsTags'); return false;">GFlagsTags</a></span></span> <span class="py-op">=</span> <span class="py-op">[</span><span class="py-string">'ddp'</span><span class="py-op">,</span> <span class="py-string">'kst'</span><span class="py-op">,</span> <span class="py-string">'ust'</span><span class="py-op">,</span> <span class="py-string">'dic'</span><span class="py-op">,</span> <span class="py-string">'dwl'</span><span class="py-op">,</span> <span class="py-string">'dhc'</span><span class="py-op">,</span> <span class="py-string">'dps'</span><span class="py-op">,</span> <span class="py-string">'dpd'</span><span class="py-op">,</span> <span class="py-string">'dse'</span><span class="py-op">,</span> <span class="py-string">'cse'</span><span class="py-op">,</span> <span class="py-string">'vrf'</span><span class="py-op">,</span> <span class="py-string">'bhd'</span><span class="py-op">,</span> <span class="py-string">'ece'</span><span class="py-op">,</span> <span class="py-string">'d32'</span><span class="py-op">,</span> <span class="py-string">'eel'</span><span class="py-op">,</span> <span class="py-string">'hfc'</span><span class="py-op">,</span> <span class="py-string">'hpc'</span><span class="py-op">,</span> <span class="py-string">'htg'</span><span class="py-op">,</span> <span class="py-string">'htd'</span><span class="py-op">,</span> <span class="py-string">'htc'</span><span class="py-op">,</span> <span class="py-string">'hvc'</span><span class="py-op">,</span> <span class="py-string">'ksl'</span><span class="py-op">,</span> <span class="py-string">'eot'</span><span class="py-op">,</span> <span class="py-string">'hpa'</span><span class="py-op">,</span> <span class="py-string">'ptg'</span><span class="py-op">,</span> <span class="py-string">'scb'</span><span class="py-op">,</span> <span class="py-string">'ltd'</span><span class="py-op">,</span> <span class="py-string">'otl'</span><span class="py-op">,</span> <span class="py-string">'sls'</span><span class="py-op">,</span> <span class="py-string">'soe'</span><span class="py-op">,</span> <span class="py-string">'shg'</span><span class="py-op">]</span> </span>
<span class="py-lineno"> 29</span>  <span class="py-line"> </span>
<span class="py-lineno"> 30</span>  <span class="py-line"><span id="link-2" class="py-name"><a title="Libs.libregisters.GFlagsRef" class="py-name" href="#" onclick="doclink('link-2', 'GFlagsRef', 'Variable Libs.libregisters.GFlagsRef=Libs.libregisters-module.html#GFlagsRef'); return false;">GFlagsRef</a></span></span> <span class="py-op">=</span> <span class="py-op">{</span><span class="py-op">}</span> </span>
<span class="py-lineno"> 31</span>  <span class="py-line"><span id="link-3" class="py-name"><a title="Libs.libregisters.GFlagsRef" class="py-name" href="#" onclick="doclink('link-3', 'GFlagsRef', 'Variable Libs.libregisters.GFlagsRef=Libs.libregisters-module.html#GFlagsRef'); return false;">GFlagsRef</a></span></span><span class="py-op">[</span><span class="py-string">'ddp'</span><span class="py-op">]</span> <span class="py-op">=</span> <span class="py-op">(</span><span class="py-string">'Buffer DbgPrint output'</span><span class="py-op">,</span> <span class="py-number">0x08000000</span><span class="py-op">,</span> <span class="py-string">'FLG_DISABLE_DBGPRINT'</span><span class="py-op">,</span> <span class="py-op">[</span><span class="py-string">'Systemwide registry entry'</span><span class="py-op">,</span> <span class="py-string">'kernel mode.'</span><span class="py-op">]</span><span class="py-op">,</span> <span class="py-string">"""Suppresses debugger output from DbgPrint(), DbgPrintEx(), KdPrint(), and KdPrintEx() calls. When this output is suppressed, it does not automatically appear in the kernel debugger. However, it can still be accessed by using the !dbgprint debugger extension. """</span><span class="py-op">)</span> </span>
<span class="py-lineno"> 32</span>  <span class="py-line"><span id="link-4" class="py-name"><a title="Libs.libregisters.GFlagsRef" class="py-name" href="#" onclick="doclink('link-4', 'GFlagsRef', 'Variable Libs.libregisters.GFlagsRef=Libs.libregisters-module.html#GFlagsRef'); return false;">GFlagsRef</a></span></span><span class="py-op">[</span><span class="py-string">'kst'</span><span class="py-op">]</span> <span class="py-op">=</span> <span class="py-op">(</span><span class="py-string">'Create kernel mode stack trace database'</span><span class="py-op">,</span> <span class="py-number">0x2000</span><span class="py-op">,</span> <span class="py-string">'FLG_KERNEL_STACK_TRACE_DB'</span><span class="py-op">,</span> <span class="py-op">[</span><span class="py-string">'Systemwide registry entry.'</span><span class="py-op">]</span><span class="py-op">,</span> <span class="py-string">"""Creates a run-time stack trace database of kernel operations, such as resource objects and object management operations. This feature works only when using a "checked build," that is, an internal debugging build of the operating system. """</span><span class="py-op">)</span> </span>
<span class="py-lineno"> 33</span>  <span class="py-line"><span id="link-5" class="py-name"><a title="Libs.libregisters.GFlagsRef" class="py-name" href="#" onclick="doclink('link-5', 'GFlagsRef', 'Variable Libs.libregisters.GFlagsRef=Libs.libregisters-module.html#GFlagsRef'); return false;">GFlagsRef</a></span></span><span class="py-op">[</span><span class="py-string">'ust'</span><span class="py-op">]</span> <span class="py-op">=</span> <span class="py-op">(</span><span class="py-string">'Create user mode stack trace database'</span><span class="py-op">,</span> <span class="py-number">0x1000</span><span class="py-op">,</span> <span class="py-string">'FLG_USER_STACK_TRACE_DB'</span><span class="py-op">,</span> <span class="py-op">[</span><span class="py-string">'Systemwide registry entry'</span><span class="py-op">,</span> <span class="py-string">'kernel mode'</span><span class="py-op">,</span> <span class="py-string">'image file registry entry.'</span><span class="py-op">]</span><span class="py-op">,</span> <span class="py-string">"""Creates a run-time stack trace database in the address space of a particular process (image file mode) or all processes (systemwide). """</span><span class="py-op">)</span> </span>
<span class="py-lineno"> 34</span>  <span class="py-line"><span id="link-6" class="py-name"><a title="Libs.libregisters.GFlagsRef" class="py-name" href="#" onclick="doclink('link-6', 'GFlagsRef', 'Variable Libs.libregisters.GFlagsRef=Libs.libregisters-module.html#GFlagsRef'); return false;">GFlagsRef</a></span></span><span class="py-op">[</span><span class="py-string">'dic'</span><span class="py-op">]</span> <span class="py-op">=</span> <span class="py-op">(</span><span class="py-string">'Debug initial command'</span><span class="py-op">,</span> <span class="py-number">0x4</span><span class="py-op">,</span> <span class="py-string">'FLG_DEBUG_INITIAL_COMMAND'</span><span class="py-op">,</span> <span class="py-op">[</span><span class="py-string">'Systemwide registry entry'</span><span class="py-op">,</span> <span class="py-string">'kernel mode.'</span><span class="py-op">]</span><span class="py-op">,</span> <span class="py-string">"""Runs Winlogon in the Windows Symbolic Debugger (Ntsd.exe) with the -d parameter, which directs its output to the kernel debugger console. """</span><span class="py-op">)</span> </span>
<span class="py-lineno"> 35</span>  <span class="py-line"><span id="link-7" class="py-name"><a title="Libs.libregisters.GFlagsRef" class="py-name" href="#" onclick="doclink('link-7', 'GFlagsRef', 'Variable Libs.libregisters.GFlagsRef=Libs.libregisters-module.html#GFlagsRef'); return false;">GFlagsRef</a></span></span><span class="py-op">[</span><span class="py-string">'dwl'</span><span class="py-op">]</span> <span class="py-op">=</span> <span class="py-op">(</span><span class="py-string">'Debug Winlogon'</span><span class="py-op">,</span> <span class="py-number">0x04000000</span><span class="py-op">,</span> <span class="py-string">'FLG_DEBUG_INITIAL_COMMAND_EX'</span><span class="py-op">,</span> <span class="py-op">[</span><span class="py-string">'Systemwide registry entry'</span><span class="py-op">,</span> <span class="py-string">'kernel mode.'</span><span class="py-op">]</span><span class="py-op">,</span> <span class="py-string">"""Runs Winlogon in the Windows Symbolic Debugger (Ntsd.exe) with the following options: """</span><span class="py-op">)</span> </span>
<span class="py-lineno"> 36</span>  <span class="py-line"><span id="link-8" class="py-name"><a title="Libs.libregisters.GFlagsRef" class="py-name" href="#" onclick="doclink('link-8', 'GFlagsRef', 'Variable Libs.libregisters.GFlagsRef=Libs.libregisters-module.html#GFlagsRef'); return false;">GFlagsRef</a></span></span><span class="py-op">[</span><span class="py-string">'dhc'</span><span class="py-op">]</span> <span class="py-op">=</span> <span class="py-op">(</span><span class="py-string">'Disable heap coalesce on free'</span><span class="py-op">,</span> <span class="py-number">0x00200000</span><span class="py-op">,</span> <span class="py-string">'FLG_HEAP_DISABLE_COALESCING'</span><span class="py-op">,</span> <span class="py-op">[</span><span class="py-string">'Systemwide registry entry'</span><span class="py-op">,</span> <span class="py-string">'kernel mode'</span><span class="py-op">,</span> <span class="py-string">'image file registry entry.'</span><span class="py-op">]</span><span class="py-op">,</span> <span class="py-string">"""Leaves adjacent blocks of heap memory separate when they are freed. By default, the system combines ("coalesces") newly freed adjacent blocks into a single block. Combining the blocks takes time, but reduces fragmentation that might force the heap to allocate additional memory when it can't find contiguous memory. """</span><span class="py-op">)</span> </span>
<span class="py-lineno"> 37</span>  <span class="py-line"><span id="link-9" class="py-name"><a title="Libs.libregisters.GFlagsRef" class="py-name" href="#" onclick="doclink('link-9', 'GFlagsRef', 'Variable Libs.libregisters.GFlagsRef=Libs.libregisters-module.html#GFlagsRef'); return false;">GFlagsRef</a></span></span><span class="py-op">[</span><span class="py-string">'dps'</span><span class="py-op">]</span> <span class="py-op">=</span> <span class="py-op">(</span><span class="py-string">'Disable paging of kernel stacks'</span><span class="py-op">,</span> <span class="py-number">0x80000</span><span class="py-op">,</span> <span class="py-string">'FLG_DISABLE_PAGE_KERNEL_STACKS'</span><span class="py-op">,</span> <span class="py-op">[</span><span class="py-string">'Systemwide registry entry'</span><span class="py-op">,</span> <span class="py-string">'kernel mode.'</span><span class="py-op">]</span><span class="py-op">,</span> <span class="py-string">"""Prevents paging of the kernel mode stacks of inactive threads. Generally, the kernel mode stack cannot be paged; it is guaranteed to be resident in memory. However, the system occasionally pages the kernel stacks of inactive threads. This flag prevents these occurrences. """</span><span class="py-op">)</span> </span>
<span class="py-lineno"> 38</span>  <span class="py-line"><span id="link-10" class="py-name"><a title="Libs.libregisters.GFlagsRef" class="py-name" href="#" onclick="doclink('link-10', 'GFlagsRef', 'Variable Libs.libregisters.GFlagsRef=Libs.libregisters-module.html#GFlagsRef'); return false;">GFlagsRef</a></span></span><span class="py-op">[</span><span class="py-string">'dpd'</span><span class="py-op">]</span> <span class="py-op">=</span> <span class="py-op">(</span><span class="py-string">'Disable protected DLL verification'</span><span class="py-op">,</span> <span class="py-number">0x80000000</span><span class="py-op">,</span> <span class="py-string">'FLG_DISABLE_PROTDLLS'</span><span class="py-op">,</span> <span class="py-op">[</span><span class="py-string">'Systemwide registry entry'</span><span class="py-op">,</span> <span class="py-string">'kernel mode'</span><span class="py-op">,</span> <span class="py-string">'image file registry entry.'</span><span class="py-op">]</span><span class="py-op">,</span> <span class="py-string">""""""</span><span class="py-op">)</span> </span>
<span class="py-lineno"> 39</span>  <span class="py-line"><span id="link-11" class="py-name"><a title="Libs.libregisters.GFlagsRef" class="py-name" href="#" onclick="doclink('link-11', 'GFlagsRef', 'Variable Libs.libregisters.GFlagsRef=Libs.libregisters-module.html#GFlagsRef'); return false;">GFlagsRef</a></span></span><span class="py-op">[</span><span class="py-string">'dse'</span><span class="py-op">]</span> <span class="py-op">=</span> <span class="py-op">(</span><span class="py-string">'Disable stack extension'</span><span class="py-op">,</span> <span class="py-number">0x10000</span><span class="py-op">,</span> <span class="py-string">'FLG_DISABLE_STACK_EXTENSION'</span><span class="py-op">,</span> <span class="py-op">[</span><span class="py-string">'image file registry entry.'</span><span class="py-op">]</span><span class="py-op">,</span> <span class="py-string">"""Prevents the kernel from extending the stacks of the threads in the process beyond the initial memory committed. This is used to simulate low memory conditions (where stack extensions fail) and to test the strategic system processes that are expected to run well even with low memory. """</span><span class="py-op">)</span> </span>
<span class="py-lineno"> 40</span>  <span class="py-line"><span id="link-12" class="py-name"><a title="Libs.libregisters.GFlagsRef" class="py-name" href="#" onclick="doclink('link-12', 'GFlagsRef', 'Variable Libs.libregisters.GFlagsRef=Libs.libregisters-module.html#GFlagsRef'); return false;">GFlagsRef</a></span></span><span class="py-op">[</span><span class="py-string">'cse'</span><span class="py-op">]</span> <span class="py-op">=</span> <span class="py-op">(</span><span class="py-string">'Early critical section event creation'</span><span class="py-op">,</span> <span class="py-number">0x10000000</span><span class="py-op">,</span> <span class="py-string">'FLG_CRITSEC_EVENT_CREATION'</span><span class="py-op">,</span> <span class="py-op">[</span><span class="py-string">'Systemwide registry entry'</span><span class="py-op">,</span> <span class="py-string">'kernel mode'</span><span class="py-op">,</span> <span class="py-string">'image file registry entry.'</span><span class="py-op">]</span><span class="py-op">,</span> <span class="py-string">"""Creates event handles when a critical section is initialized, rather than waiting until the event is needed. When the system cannot create an event, it generates the exception during initialization and the calls to enter and leave the critical section do not fail. """</span><span class="py-op">)</span> </span>
<span class="py-lineno"> 41</span>  <span class="py-line"><span id="link-13" class="py-name"><a title="Libs.libregisters.GFlagsRef" class="py-name" href="#" onclick="doclink('link-13', 'GFlagsRef', 'Variable Libs.libregisters.GFlagsRef=Libs.libregisters-module.html#GFlagsRef'); return false;">GFlagsRef</a></span></span><span class="py-op">[</span><span class="py-string">'vrf'</span><span class="py-op">]</span> <span class="py-op">=</span> <span class="py-op">(</span><span class="py-string">'Enable application verifier'</span><span class="py-op">,</span> <span class="py-number">0x100</span><span class="py-op">,</span> <span class="py-string">'FLG_APPLICATION_VERIFIER'</span><span class="py-op">,</span> <span class="py-op">[</span><span class="py-string">'Systemwide registry entry'</span><span class="py-op">,</span> <span class="py-string">'kernel mode'</span><span class="py-op">,</span> <span class="py-string">'image file registry entry.'</span><span class="py-op">]</span><span class="py-op">,</span> <span class="py-string">""""""</span><span class="py-op">)</span> </span>
<span class="py-lineno"> 42</span>  <span class="py-line"><span id="link-14" class="py-name"><a title="Libs.libregisters.GFlagsRef" class="py-name" href="#" onclick="doclink('link-14', 'GFlagsRef', 'Variable Libs.libregisters.GFlagsRef=Libs.libregisters-module.html#GFlagsRef'); return false;">GFlagsRef</a></span></span><span class="py-op">[</span><span class="py-string">'bhd'</span><span class="py-op">]</span> <span class="py-op">=</span> <span class="py-op">(</span><span class="py-string">'Enable bad handles detection'</span><span class="py-op">,</span> <span class="py-number">0x40000000</span><span class="py-op">,</span> <span class="py-string">'FLG_ENABLE_HANDLE_EXCEPTIONS'</span><span class="py-op">,</span> <span class="py-op">[</span><span class="py-string">'Systemwide registry entry'</span><span class="py-op">,</span> <span class="py-string">'kernel mode.'</span><span class="py-op">]</span><span class="py-op">,</span> <span class="py-string">"""Raises a user mode exception (STATUS_INVALID_HANDLE) whenever a user mode process passes an invalid handle to the Object Manager. """</span><span class="py-op">)</span> </span>
<span class="py-lineno"> 43</span>  <span class="py-line"><span id="link-15" class="py-name"><a title="Libs.libregisters.GFlagsRef" class="py-name" href="#" onclick="doclink('link-15', 'GFlagsRef', 'Variable Libs.libregisters.GFlagsRef=Libs.libregisters-module.html#GFlagsRef'); return false;">GFlagsRef</a></span></span><span class="py-op">[</span><span class="py-string">'ece'</span><span class="py-op">]</span> <span class="py-op">=</span> <span class="py-op">(</span><span class="py-string">'Enable close exception'</span><span class="py-op">,</span> <span class="py-number">0x00400000</span><span class="py-op">,</span> <span class="py-string">'FLG_ENABLE_CLOSE_EXCEPTIONS'</span><span class="py-op">,</span> <span class="py-op">[</span><span class="py-string">'Systemwide registry entry'</span><span class="py-op">,</span> <span class="py-string">'kernel mode.'</span><span class="py-op">]</span><span class="py-op">,</span> <span class="py-string">"""Raises a user mode exception whenever an invalid handle is passed to the CloseHandle() interface or related interfaces, such as SetEvent(), that take handles as arguments. """</span><span class="py-op">)</span> </span>
<span class="py-lineno"> 44</span>  <span class="py-line"><span id="link-16" class="py-name"><a title="Libs.libregisters.GFlagsRef" class="py-name" href="#" onclick="doclink('link-16', 'GFlagsRef', 'Variable Libs.libregisters.GFlagsRef=Libs.libregisters-module.html#GFlagsRef'); return false;">GFlagsRef</a></span></span><span class="py-op">[</span><span class="py-string">'d32'</span><span class="py-op">]</span> <span class="py-op">=</span> <span class="py-op">(</span><span class="py-string">'Enable debugging of Win32 subsystem'</span><span class="py-op">,</span> <span class="py-number">0x20000</span><span class="py-op">,</span> <span class="py-string">'FLG_ENABLE_CSRDEBUG'</span><span class="py-op">,</span> <span class="py-op">[</span><span class="py-string">'Systemwide registry entry'</span><span class="py-op">,</span> <span class="py-string">'kernel mode.'</span><span class="py-op">]</span><span class="py-op">,</span> <span class="py-string">""""""</span><span class="py-op">)</span> </span>
<span class="py-lineno"> 45</span>  <span class="py-line"><span id="link-17" class="py-name"><a title="Libs.libregisters.GFlagsRef" class="py-name" href="#" onclick="doclink('link-17', 'GFlagsRef', 'Variable Libs.libregisters.GFlagsRef=Libs.libregisters-module.html#GFlagsRef'); return false;">GFlagsRef</a></span></span><span class="py-op">[</span><span class="py-string">'eel'</span><span class="py-op">]</span> <span class="py-op">=</span> <span class="py-op">(</span><span class="py-string">'Enable exception logging'</span><span class="py-op">,</span> <span class="py-number">0x00800000</span><span class="py-op">,</span> <span class="py-string">'FLG_ENABLE_EXCEPTION_LOGGING'</span><span class="py-op">,</span> <span class="py-op">[</span><span class="py-string">'Systemwide registry entry'</span><span class="py-op">,</span> <span class="py-string">'kernel mode.'</span><span class="py-op">]</span><span class="py-op">,</span> <span class="py-string">"""Creates a log of exception records in the kernel run-time library. You can access the log from the kernel debugger. """</span><span class="py-op">)</span> </span>
<span class="py-lineno"> 46</span>  <span class="py-line"><span id="link-18" class="py-name"><a title="Libs.libregisters.GFlagsRef" class="py-name" href="#" onclick="doclink('link-18', 'GFlagsRef', 'Variable Libs.libregisters.GFlagsRef=Libs.libregisters-module.html#GFlagsRef'); return false;">GFlagsRef</a></span></span><span class="py-op">[</span><span class="py-string">'hfc'</span><span class="py-op">]</span> <span class="py-op">=</span> <span class="py-op">(</span><span class="py-string">'Enable heap free checking'</span><span class="py-op">,</span> <span class="py-number">0x20</span><span class="py-op">,</span> <span class="py-string">'FLG_HEAP_ENABLE_FREE_CHECK'</span><span class="py-op">,</span> <span class="py-op">[</span><span class="py-string">'Systemwide registry entry'</span><span class="py-op">,</span> <span class="py-string">'kernel mode'</span><span class="py-op">,</span> <span class="py-string">'image file registry entry.'</span><span class="py-op">]</span><span class="py-op">,</span> <span class="py-string">"""Validates the heap when it is freed. """</span><span class="py-op">)</span> </span>
<span class="py-lineno"> 47</span>  <span class="py-line"><span id="link-19" class="py-name"><a title="Libs.libregisters.GFlagsRef" class="py-name" href="#" onclick="doclink('link-19', 'GFlagsRef', 'Variable Libs.libregisters.GFlagsRef=Libs.libregisters-module.html#GFlagsRef'); return false;">GFlagsRef</a></span></span><span class="py-op">[</span><span class="py-string">'hpc'</span><span class="py-op">]</span> <span class="py-op">=</span> <span class="py-op">(</span><span class="py-string">'Enable heap parameter checking'</span><span class="py-op">,</span> <span class="py-number">0x40</span><span class="py-op">,</span> <span class="py-string">'FLG_HEAP_VALIDATE_PARAMETERS'</span><span class="py-op">,</span> <span class="py-op">[</span><span class="py-string">'Systemwide registry entry'</span><span class="py-op">,</span> <span class="py-string">'kernel mode'</span><span class="py-op">,</span> <span class="py-string">'image file registry entry.'</span><span class="py-op">]</span><span class="py-op">,</span> <span class="py-string">"""Verifies some aspects of the heap whenever a heap API is called. """</span><span class="py-op">)</span> </span>
<span class="py-lineno"> 48</span>  <span class="py-line"><span id="link-20" class="py-name"><a title="Libs.libregisters.GFlagsRef" class="py-name" href="#" onclick="doclink('link-20', 'GFlagsRef', 'Variable Libs.libregisters.GFlagsRef=Libs.libregisters-module.html#GFlagsRef'); return false;">GFlagsRef</a></span></span><span class="py-op">[</span><span class="py-string">'htg'</span><span class="py-op">]</span> <span class="py-op">=</span> <span class="py-op">(</span><span class="py-string">'Enable heap tagging'</span><span class="py-op">,</span> <span class="py-number">0x800</span><span class="py-op">,</span> <span class="py-string">'FLG_HEAP_ENABLE_TAGGING'</span><span class="py-op">,</span> <span class="py-op">[</span><span class="py-string">'Systemwide registry entry'</span><span class="py-op">,</span> <span class="py-string">'kernel mode'</span><span class="py-op">,</span> <span class="py-string">'image file registry entry.'</span><span class="py-op">]</span><span class="py-op">,</span> <span class="py-string">"""Assigns unique tags to heap allocations. You can display the tag by using the !heap debugger extension with the -t parameter. """</span><span class="py-op">)</span> </span>
<span class="py-lineno"> 49</span>  <span class="py-line"><span id="link-21" class="py-name"><a title="Libs.libregisters.GFlagsRef" class="py-name" href="#" onclick="doclink('link-21', 'GFlagsRef', 'Variable Libs.libregisters.GFlagsRef=Libs.libregisters-module.html#GFlagsRef'); return false;">GFlagsRef</a></span></span><span class="py-op">[</span><span class="py-string">'htd'</span><span class="py-op">]</span> <span class="py-op">=</span> <span class="py-op">(</span><span class="py-string">'Enable heap tagging by DLL'</span><span class="py-op">,</span> <span class="py-number">0x8000</span><span class="py-op">,</span> <span class="py-string">'FLG_HEAP_ENABLE_TAG_BY_DLL'</span><span class="py-op">,</span> <span class="py-op">[</span><span class="py-string">'Systemwide registry entry'</span><span class="py-op">,</span> <span class="py-string">'kernel mode'</span><span class="py-op">,</span> <span class="py-string">'image file registry entry.'</span><span class="py-op">]</span><span class="py-op">,</span> <span class="py-string">"""Assigns a unique tag to heap allocations created by the same DLL. You can display the tag by using the !heap debugger extension with the -t parameter. """</span><span class="py-op">)</span> </span>
<span class="py-lineno"> 50</span>  <span class="py-line"><span id="link-22" class="py-name"><a title="Libs.libregisters.GFlagsRef" class="py-name" href="#" onclick="doclink('link-22', 'GFlagsRef', 'Variable Libs.libregisters.GFlagsRef=Libs.libregisters-module.html#GFlagsRef'); return false;">GFlagsRef</a></span></span><span class="py-op">[</span><span class="py-string">'htc'</span><span class="py-op">]</span> <span class="py-op">=</span> <span class="py-op">(</span><span class="py-string">'Enable heap tail checking'</span><span class="py-op">,</span> <span class="py-number">0x10</span><span class="py-op">,</span> <span class="py-string">'FLG_HEAP_ENABLE_TAIL_CHECK'</span><span class="py-op">,</span> <span class="py-op">[</span><span class="py-string">'Systemwide registry entry'</span><span class="py-op">,</span> <span class="py-string">'kernel mode'</span><span class="py-op">,</span> <span class="py-string">'image file registry entry.'</span><span class="py-op">]</span><span class="py-op">,</span> <span class="py-string">"""Checks for buffer overruns when the heap is freed. This flag adds a short pattern to the end of each allocation. The Windows heap manager detects the pattern when the block is freed and, if the block was modified, the heap manager breaks into the debugger. """</span><span class="py-op">)</span> </span>
<span class="py-lineno"> 51</span>  <span class="py-line"><span id="link-23" class="py-name"><a title="Libs.libregisters.GFlagsRef" class="py-name" href="#" onclick="doclink('link-23', 'GFlagsRef', 'Variable Libs.libregisters.GFlagsRef=Libs.libregisters-module.html#GFlagsRef'); return false;">GFlagsRef</a></span></span><span class="py-op">[</span><span class="py-string">'hvc'</span><span class="py-op">]</span> <span class="py-op">=</span> <span class="py-op">(</span><span class="py-string">'Enable heap validation on call'</span><span class="py-op">,</span> <span class="py-number">0x80</span><span class="py-op">,</span> <span class="py-string">'FLG_HEAP_VALIDATE_ALL'</span><span class="py-op">,</span> <span class="py-op">[</span><span class="py-string">'Systemwide registry entry'</span><span class="py-op">,</span> <span class="py-string">'kernel mode'</span><span class="py-op">,</span> <span class="py-string">'image file registry entry.'</span><span class="py-op">]</span><span class="py-op">,</span> <span class="py-string">"""Validates the entire heap each time a heap API is called. """</span><span class="py-op">)</span> </span>
<span class="py-lineno"> 52</span>  <span class="py-line"><span id="link-24" class="py-name"><a title="Libs.libregisters.GFlagsRef" class="py-name" href="#" onclick="doclink('link-24', 'GFlagsRef', 'Variable Libs.libregisters.GFlagsRef=Libs.libregisters-module.html#GFlagsRef'); return false;">GFlagsRef</a></span></span><span class="py-op">[</span><span class="py-string">'ksl'</span><span class="py-op">]</span> <span class="py-op">=</span> <span class="py-op">(</span><span class="py-string">'Enable loading of kernel debugger symbols'</span><span class="py-op">,</span> <span class="py-number">0x40000</span><span class="py-op">,</span> <span class="py-string">'FLG_ENABLE_KDEBUG_SYMBOL_LOAD'</span><span class="py-op">,</span> <span class="py-op">[</span><span class="py-string">'Systemwide registry entry'</span><span class="py-op">,</span> <span class="py-string">'kernel mode.'</span><span class="py-op">]</span><span class="py-op">,</span> <span class="py-string">"""Loads kernel symbols into the kernel memory space the next time the system starts. The kernel symbols are used in kernel profiling and by advanced kernel debugging tools. """</span><span class="py-op">)</span> </span>
<span class="py-lineno"> 53</span>  <span class="py-line"><span id="link-25" class="py-name"><a title="Libs.libregisters.GFlagsRef" class="py-name" href="#" onclick="doclink('link-25', 'GFlagsRef', 'Variable Libs.libregisters.GFlagsRef=Libs.libregisters-module.html#GFlagsRef'); return false;">GFlagsRef</a></span></span><span class="py-op">[</span><span class="py-string">'eot'</span><span class="py-op">]</span> <span class="py-op">=</span> <span class="py-op">(</span><span class="py-string">'Enable object handle type tagging'</span><span class="py-op">,</span> <span class="py-number">0x01000000</span><span class="py-op">,</span> <span class="py-string">'FLG_ENABLE_HANDLE_TYPE_TAGGING'</span><span class="py-op">,</span> <span class="py-op">[</span><span class="py-string">'Systemwide registry entry'</span><span class="py-op">,</span> <span class="py-string">'kernel mode.'</span><span class="py-op">]</span><span class="py-op">,</span> <span class="py-string">"""This flag appears in Gflags, but it has no effect on the operating system. """</span><span class="py-op">)</span> </span>
<span class="py-lineno"> 54</span>  <span class="py-line"><span id="link-26" class="py-name"><a title="Libs.libregisters.GFlagsRef" class="py-name" href="#" onclick="doclink('link-26', 'GFlagsRef', 'Variable Libs.libregisters.GFlagsRef=Libs.libregisters-module.html#GFlagsRef'); return false;">GFlagsRef</a></span></span><span class="py-op">[</span><span class="py-string">'hpa'</span><span class="py-op">]</span> <span class="py-op">=</span> <span class="py-op">(</span><span class="py-string">'Enable page heap'</span><span class="py-op">,</span> <span class="py-number">0x02000000</span><span class="py-op">,</span> <span class="py-string">'FLG_HEAP_PAGE_ALLOCS'</span><span class="py-op">,</span> <span class="py-op">[</span><span class="py-string">'Systemwide registry entry'</span><span class="py-op">,</span> <span class="py-string">'kernel mode'</span><span class="py-op">,</span> <span class="py-string">'image file registry entry.'</span><span class="py-op">]</span><span class="py-op">,</span> <span class="py-string">"""Turns on page heap debugging, which verifies dynamic heap memory operations, including allocations and frees, and causes a debugger break when it detects a heap error. """</span><span class="py-op">)</span> </span>
<span class="py-lineno"> 55</span>  <span class="py-line"><span id="link-27" class="py-name"><a title="Libs.libregisters.GFlagsRef" class="py-name" href="#" onclick="doclink('link-27', 'GFlagsRef', 'Variable Libs.libregisters.GFlagsRef=Libs.libregisters-module.html#GFlagsRef'); return false;">GFlagsRef</a></span></span><span class="py-op">[</span><span class="py-string">'ptg'</span><span class="py-op">]</span> <span class="py-op">=</span> <span class="py-op">(</span><span class="py-string">'Enable pool tagging'</span><span class="py-op">,</span> <span class="py-number">0x400</span><span class="py-op">,</span> <span class="py-string">'FLG_POOL_ENABLE_TAGGING'</span><span class="py-op">,</span> <span class="py-op">[</span><span class="py-string">'Systemwide registry entry.'</span><span class="py-op">]</span><span class="py-op">,</span> <span class="py-string">"""Collects data and calculates statistics about pool memory allocations. The data is grouped by pool tag value. Several tools that diagnose memory leaks and other kernel pool errors use the resulting data. """</span><span class="py-op">)</span> </span>
<span class="py-lineno"> 56</span>  <span class="py-line"><span id="link-28" class="py-name"><a title="Libs.libregisters.GFlagsRef" class="py-name" href="#" onclick="doclink('link-28', 'GFlagsRef', 'Variable Libs.libregisters.GFlagsRef=Libs.libregisters-module.html#GFlagsRef'); return false;">GFlagsRef</a></span></span><span class="py-op">[</span><span class="py-string">'scb'</span><span class="py-op">]</span> <span class="py-op">=</span> <span class="py-op">(</span><span class="py-string">'Enable system critical breaks'</span><span class="py-op">,</span> <span class="py-number">0x100000</span><span class="py-op">,</span> <span class="py-string">'FLG_ENABLE_SYSTEM_CRIT_BREAKS'</span><span class="py-op">,</span> <span class="py-op">[</span><span class="py-string">'Systemwide registry entry'</span><span class="py-op">,</span> <span class="py-string">'kernel mode'</span><span class="py-op">,</span> <span class="py-string">'image file registry entry.'</span><span class="py-op">]</span><span class="py-op">,</span> <span class="py-string">"""For per-process (image file) only: Forces a system breakpoint into the debugger whenever the specified process stops abnormally. This flag is effective only when the process calls the RtlSetProcessBreakOnExit() and RtlSetThreadBreakOnExit() interfaces. """</span><span class="py-op">)</span> </span>
<span class="py-lineno"> 57</span>  <span class="py-line"><span id="link-29" class="py-name"><a title="Libs.libregisters.GFlagsRef" class="py-name" href="#" onclick="doclink('link-29', 'GFlagsRef', 'Variable Libs.libregisters.GFlagsRef=Libs.libregisters-module.html#GFlagsRef'); return false;">GFlagsRef</a></span></span><span class="py-op">[</span><span class="py-string">'ltd'</span><span class="py-op">]</span> <span class="py-op">=</span> <span class="py-op">(</span><span class="py-string">'Load DLLs top-down'</span><span class="py-op">,</span> <span class="py-number">0x20000000</span><span class="py-op">,</span> <span class="py-string">'FLG_LDR_TOP_DOWN'</span><span class="py-op">,</span> <span class="py-op">[</span><span class="py-string">'Systemwide registry entry'</span><span class="py-op">,</span> <span class="py-string">'kernel mode'</span><span class="py-op">,</span> <span class="py-string">'image file registry entry.'</span><span class="py-op">]</span><span class="py-op">,</span> <span class="py-string">"""Loads DLLs at the highest possible address. This flag is used to test 64-bit code for pointer truncation errors, because the most significant 32 bits of the pointers are not zeroes. It is designed for code running on the 64-bit versions of the Windows Server 2003. """</span><span class="py-op">)</span> </span>
<span class="py-lineno"> 58</span>  <span class="py-line"><span id="link-30" class="py-name"><a title="Libs.libregisters.GFlagsRef" class="py-name" href="#" onclick="doclink('link-30', 'GFlagsRef', 'Variable Libs.libregisters.GFlagsRef=Libs.libregisters-module.html#GFlagsRef'); return false;">GFlagsRef</a></span></span><span class="py-op">[</span><span class="py-string">'otl'</span><span class="py-op">]</span> <span class="py-op">=</span> <span class="py-op">(</span><span class="py-string">'Maintain a list of objects for each type'</span><span class="py-op">,</span> <span class="py-number">0x4000</span><span class="py-op">,</span> <span class="py-string">'FLG_MAINTAIN_OBJECT_TYPELIST'</span><span class="py-op">,</span> <span class="py-op">[</span><span class="py-string">'Systemwide registry entry'</span><span class="py-op">,</span> <span class="py-string">'kernel mode.'</span><span class="py-op">]</span><span class="py-op">,</span> <span class="py-string">"""Collects and maintains a list of active objects by object type (for example, event, mutex, and semaphore). """</span><span class="py-op">)</span> </span>
<span class="py-lineno"> 59</span>  <span class="py-line"><span id="link-31" class="py-name"><a title="Libs.libregisters.GFlagsRef" class="py-name" href="#" onclick="doclink('link-31', 'GFlagsRef', 'Variable Libs.libregisters.GFlagsRef=Libs.libregisters-module.html#GFlagsRef'); return false;">GFlagsRef</a></span></span><span class="py-op">[</span><span class="py-string">'sls'</span><span class="py-op">]</span> <span class="py-op">=</span> <span class="py-op">(</span><span class="py-string">'Show loader snaps'</span><span class="py-op">,</span> <span class="py-number">0x2</span><span class="py-op">,</span> <span class="py-string">'FLG_SHOW_LDR_SNAPS'</span><span class="py-op">,</span> <span class="py-op">[</span><span class="py-string">'Systemwide registry entry'</span><span class="py-op">,</span> <span class="py-string">'kernel mode'</span><span class="py-op">,</span> <span class="py-string">'image file registry entry.'</span><span class="py-op">]</span><span class="py-op">,</span> <span class="py-string">"""Captures detailed information about the loading and unloading of executable images and their supporting library modules. """</span><span class="py-op">)</span> </span>
<span class="py-lineno"> 60</span>  <span class="py-line"><span id="link-32" class="py-name"><a title="Libs.libregisters.GFlagsRef" class="py-name" href="#" onclick="doclink('link-32', 'GFlagsRef', 'Variable Libs.libregisters.GFlagsRef=Libs.libregisters-module.html#GFlagsRef'); return false;">GFlagsRef</a></span></span><span class="py-op">[</span><span class="py-string">'soe'</span><span class="py-op">]</span> <span class="py-op">=</span> <span class="py-op">(</span><span class="py-string">'Stop on exception'</span><span class="py-op">,</span> <span class="py-number">0x1</span><span class="py-op">,</span> <span class="py-string">'FLG_STOP_ON_EXCEPTION'</span><span class="py-op">,</span> <span class="py-op">[</span><span class="py-string">'Systemwide registry entry'</span><span class="py-op">,</span> <span class="py-string">'kernel mode'</span><span class="py-op">,</span> <span class="py-string">'image file registry entry.'</span><span class="py-op">]</span><span class="py-op">,</span> <span class="py-string">"""The kernel breaks into the kernel debugger whenever a kernel mode exception occurs. The system passes all first chance exceptions (except for STATUS_PORT_DISCONNECT) with a severity of Warning or Error to the debugger before passing them to a local exception handler. """</span><span class="py-op">)</span> </span>
<span class="py-lineno"> 61</span>  <span class="py-line"><span id="link-33" class="py-name"><a title="Libs.libregisters.GFlagsRef" class="py-name" href="#" onclick="doclink('link-33', 'GFlagsRef', 'Variable Libs.libregisters.GFlagsRef=Libs.libregisters-module.html#GFlagsRef'); return false;">GFlagsRef</a></span></span><span class="py-op">[</span><span class="py-string">'shg'</span><span class="py-op">]</span> <span class="py-op">=</span> <span class="py-op">(</span><span class="py-string">'Stop on hung GUI'</span><span class="py-op">,</span> <span class="py-number">0x8</span><span class="py-op">,</span> <span class="py-string">'FLG_STOP_ON_HUNG_GUI'</span><span class="py-op">,</span> <span class="py-op">[</span><span class="py-string">'kernel mode'</span><span class="py-op">]</span><span class="py-op">,</span> <span class="py-string">""""""</span><span class="py-op">)</span> </span>
<span class="py-lineno"> 62</span>  <span class="py-line"> </span>
<span class="py-lineno"> 63</span>  <span class="py-line"> </span>
<span class="py-lineno"> 64</span>  <span class="py-line"><span class="py-comment"># For a complete usage of this Class, check the Pycommand 'gflags.py'</span> </span>
<a name="GFlags"></a><div id="GFlags-def"><span class="py-lineno"> 65</span> <a class="py-toggle" href="#" id="GFlags-toggle" onclick="toggle('GFlags'); return false;">-</a><span class="py-line"><span class="py-comment"></span><span class="py-keyword">class</span> <a class="py-def-name" href="Libs.libregisters.GFlags-class.html">GFlags</a><span class="py-op">:</span> </span>
</div><div id="GFlags-collapsed" style="display:none;" pad="+++" indent="++++"></div><div id="GFlags-expanded"><a name="GFlags.__init__"></a><div id="GFlags.__init__-def"><span class="py-lineno"> 66</span> <a class="py-toggle" href="#" id="GFlags.__init__-toggle" onclick="toggle('GFlags.__init__'); return false;">-</a><span class="py-line">    <span class="py-keyword">def</span> <a class="py-def-name" href="Libs.libregisters.GFlags-class.html#__init__">__init__</a><span class="py-op">(</span><span class="py-param">self</span><span class="py-op">,</span> <span class="py-param">processname</span> <span class="py-op">=</span> <span class="py-string">""</span><span class="py-op">)</span><span class="py-op">:</span> </span>
</div><div id="GFlags.__init__-collapsed" style="display:none;" pad="+++" indent="++++++++"></div><div id="GFlags.__init__-expanded"><span class="py-lineno"> 67</span>  <span class="py-line">        <span class="py-docstring">""" </span> </span>
<span class="py-lineno"> 68</span>  <span class="py-line"><span class="py-docstring">        GFlags class  enable and disable Windows global flags</span> </span>
<span class="py-lineno"> 69</span>  <span class="py-line"><span class="py-docstring">        </span> </span>
<span class="py-lineno"> 70</span>  <span class="py-line"><span class="py-docstring">        @type  processname: STRING</span> </span>
<span class="py-lineno"> 71</span>  <span class="py-line"><span class="py-docstring">        @param processname: (Optional) Process name (If is unset, it will use the system global flags)</span> </span>
<span class="py-lineno"> 72</span>  <span class="py-line"><span class="py-docstring">        """</span> </span>
<span class="py-lineno"> 73</span>  <span class="py-line">        <span class="py-name">self</span><span class="py-op">.</span><span class="py-name">processname</span> <span class="py-op">=</span> <span class="py-name">processname</span> </span>
<span class="py-lineno"> 74</span>  <span class="py-line">         </span>
<span class="py-lineno"> 75</span>  <span class="py-line">        <span class="py-keyword">if</span> <span class="py-name">self</span><span class="py-op">.</span><span class="py-name">processname</span><span class="py-op">:</span> </span>
<span class="py-lineno"> 76</span>  <span class="py-line">            <span class="py-name">self</span><span class="py-op">.</span><span class="py-name">subkey</span> <span class="py-op">=</span> <span class="py-string">"SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\Image File Execution Options\\%s"</span> <span class="py-op">%</span> <span class="py-name">self</span><span class="py-op">.</span><span class="py-name">processname</span> </span>
<span class="py-lineno"> 77</span>  <span class="py-line">        <span class="py-keyword">else</span><span class="py-op">:</span> </span>
<span class="py-lineno"> 78</span>  <span class="py-line">            <span class="py-name">self</span><span class="py-op">.</span><span class="py-name">subkey</span> <span class="py-op">=</span> <span class="py-string">"SYSTEM\\CurrentControlSet\\Control\\Session Manager\\"</span> </span>
</div><span class="py-lineno"> 79</span>  <span class="py-line">             </span>
<span class="py-lineno"> 80</span>  <span class="py-line">        </span>
<a name="GFlags._query"></a><div id="GFlags._query-def"><span class="py-lineno"> 81</span> <a class="py-toggle" href="#" id="GFlags._query-toggle" onclick="toggle('GFlags._query'); return false;">-</a><span class="py-line">    <span class="py-keyword">def</span> <a class="py-def-name" href="Libs.libregisters.GFlags-class.html#_query">_query</a><span class="py-op">(</span><span class="py-param">self</span><span class="py-op">)</span><span class="py-op">:</span> </span>
</div><div id="GFlags._query-collapsed" style="display:none;" pad="+++" indent="++++++++"></div><div id="GFlags._query-expanded"><span class="py-lineno"> 82</span>  <span class="py-line">        <span class="py-keyword">try</span><span class="py-op">:</span> </span>
<span class="py-lineno"> 83</span>  <span class="py-line">            <span class="py-name">hkey</span> <span class="py-op">=</span> <span class="py-name">_winreg</span><span class="py-op">.</span><span class="py-name">OpenKey</span><span class="py-op">(</span><span class="py-name">_winreg</span><span class="py-op">.</span><span class="py-name">HKEY_LOCAL_MACHINE</span><span class="py-op">,</span> <span class="py-name">self</span><span class="py-op">.</span><span class="py-name">subkey</span><span class="py-op">)</span> </span>
<span class="py-lineno"> 84</span>  <span class="py-line">        <span class="py-keyword">except</span> <span class="py-name">WindowsError</span><span class="py-op">:</span> </span>
<span class="py-lineno"> 85</span>  <span class="py-line">            <span class="py-keyword">raise</span> <span class="py-name">Exception</span><span class="py-op">,</span> <span class="py-string">"Cannot Openkey for Query (%s)"</span> <span class="py-op">%</span> <span class="py-name">self</span><span class="py-op">.</span><span class="py-name">subkey</span> </span>
<span class="py-lineno"> 86</span>  <span class="py-line">         </span>
<span class="py-lineno"> 87</span>  <span class="py-line">        <span class="py-keyword">try</span><span class="py-op">:</span> </span>
<span class="py-lineno"> 88</span>  <span class="py-line">            <span class="py-keyword">return</span> <span class="py-name">_winreg</span><span class="py-op">.</span><span class="py-name">QueryValueEx</span><span class="py-op">(</span><span class="py-name">hkey</span><span class="py-op">,</span> <span class="py-string">"GlobalFlag"</span><span class="py-op">)</span><span class="py-op">[</span><span class="py-number">0</span><span class="py-op">]</span> </span>
<span class="py-lineno"> 89</span>  <span class="py-line">        <span class="py-keyword">except</span> <span class="py-name">WindowsError</span><span class="py-op">:</span> </span>
<span class="py-lineno"> 90</span>  <span class="py-line">            <span class="py-keyword">raise</span> <span class="py-name">Exception</span><span class="py-op">,</span> <span class="py-string">"Cannot Query value (%s\\%s)"</span> <span class="py-op">%</span> <span class="py-op">(</span><span class="py-name">self</span><span class="py-op">.</span><span class="py-name">subkey</span><span class="py-op">,</span> <span class="py-string">"GlobalFlag"</span><span class="py-op">)</span> </span>
</div><span class="py-lineno"> 91</span>  <span class="py-line"> </span>
<a name="GFlags.GetReferencebyName"></a><div id="GFlags.GetReferencebyName-def"><span class="py-lineno"> 92</span> <a class="py-toggle" href="#" id="GFlags.GetReferencebyName-toggle" onclick="toggle('GFlags.GetReferencebyName'); return false;">-</a><span class="py-line">    <span class="py-keyword">def</span> <a class="py-def-name" href="Libs.libregisters.GFlags-class.html#GetReferencebyName">GetReferencebyName</a><span class="py-op">(</span><span class="py-param">self</span><span class="py-op">,</span> <span class="py-param">val</span><span class="py-op">)</span><span class="py-op">:</span> </span>
</div><div id="GFlags.GetReferencebyName-collapsed" style="display:none;" pad="+++" indent="++++++++"></div><div id="GFlags.GetReferencebyName-expanded"><span class="py-lineno"> 93</span>  <span class="py-line">        <span class="py-docstring">"""</span> </span>
<span class="py-lineno"> 94</span>  <span class="py-line"><span class="py-docstring">        Get Flag information by its shorcut name</span> </span>
<span class="py-lineno"> 95</span>  <span class="py-line"><span class="py-docstring">        </span> </span>
<span class="py-lineno"> 96</span>  <span class="py-line"><span class="py-docstring">        @type  val: STRING</span> </span>
<span class="py-lineno"> 97</span>  <span class="py-line"><span class="py-docstring">        @param val: Shortcut Name</span> </span>
<span class="py-lineno"> 98</span>  <span class="py-line"><span class="py-docstring">        </span> </span>
<span class="py-lineno"> 99</span>  <span class="py-line"><span class="py-docstring">        @rtype:  TUPLE</span> </span>
<span class="py-lineno">100</span>  <span class="py-line"><span class="py-docstring">        @return: A tuple containning all the internal information of a Flag</span> </span>
<span class="py-lineno">101</span>  <span class="py-line"><span class="py-docstring">        """</span> </span>
<span class="py-lineno">102</span>  <span class="py-line">        <span class="py-name">val</span> <span class="py-op">=</span> <span class="py-name">val</span><span class="py-op">.</span><span class="py-name">lower</span><span class="py-op">(</span><span class="py-op">)</span> </span>
<span class="py-lineno">103</span>  <span class="py-line">        <span class="py-keyword">try</span><span class="py-op">:</span> </span>
<span class="py-lineno">104</span>  <span class="py-line">            <span class="py-name">r</span> <span class="py-op">=</span> <span id="link-34" class="py-name"><a title="Libs.libregisters.GFlagsRef" class="py-name" href="#" onclick="doclink('link-34', 'GFlagsRef', 'Variable Libs.libregisters.GFlagsRef=Libs.libregisters-module.html#GFlagsRef'); return false;">GFlagsRef</a></span></span><span class="py-op">[</span><span class="py-name">val</span><span class="py-op">]</span> </span>
<span class="py-lineno">105</span>  <span class="py-line">        <span class="py-keyword">except</span> <span class="py-name">KeyError</span><span class="py-op">:</span> </span>
<span class="py-lineno">106</span>  <span class="py-line">            <span class="py-keyword">raise</span> <span class="py-name">Exception</span><span class="py-op">,</span> <span class="py-string">"'%s' is not a gflag value"</span> <span class="py-op">%</span> <span class="py-name">val</span> </span>
<span class="py-lineno">107</span>  <span class="py-line">        <span class="py-keyword">if</span> <span class="py-name">self</span><span class="py-op">.</span><span class="py-name">processname</span><span class="py-op">:</span> </span>
<span class="py-lineno">108</span>  <span class="py-line">            <span class="py-keyword">if</span> <span class="py-string">'image file registry entry.'</span> <span class="py-keyword">not</span> <span class="py-keyword">in</span> <span class="py-name">r</span><span class="py-op">[</span><span class="py-number">3</span><span class="py-op">]</span><span class="py-op">:</span> </span>
<span class="py-lineno">109</span>  <span class="py-line">                <span class="py-keyword">raise</span> <span class="py-name">Exception</span><span class="py-op">,</span> <span class="py-string">"Flag '%s' is not available for Image file (only for: %s)"</span> <span class="py-op">%</span> <span class="py-op">(</span><span class="py-name">val</span><span class="py-op">,</span> <span class="py-name">str</span><span class="py-op">(</span><span class="py-name">r</span><span class="py-op">[</span><span class="py-number">3</span><span class="py-op">]</span><span class="py-op">)</span><span class="py-op">)</span> </span>
<span class="py-lineno">110</span>  <span class="py-line">             </span>
<span class="py-lineno">111</span>  <span class="py-line">        <span class="py-keyword">return</span> <span class="py-name">r</span> </span>
</div><span class="py-lineno">112</span>  <span class="py-line">     </span>
<a name="GFlags.SetbyName"></a><div id="GFlags.SetbyName-def"><span class="py-lineno">113</span> <a class="py-toggle" href="#" id="GFlags.SetbyName-toggle" onclick="toggle('GFlags.SetbyName'); return false;">-</a><span class="py-line">    <span class="py-keyword">def</span> <a class="py-def-name" href="Libs.libregisters.GFlags-class.html#SetbyName">SetbyName</a><span class="py-op">(</span><span class="py-param">self</span><span class="py-op">,</span> <span class="py-param">val</span><span class="py-op">)</span><span class="py-op">:</span> </span>
</div><div id="GFlags.SetbyName-collapsed" style="display:none;" pad="+++" indent="++++++++"></div><div id="GFlags.SetbyName-expanded"><span class="py-lineno">114</span>  <span class="py-line">        <span class="py-docstring">"""</span> </span>
<span class="py-lineno">115</span>  <span class="py-line"><span class="py-docstring">        Set a Flag by its shorcut name</span> </span>
<span class="py-lineno">116</span>  <span class="py-line"><span class="py-docstring">        </span> </span>
<span class="py-lineno">117</span>  <span class="py-line"><span class="py-docstring">        @type  val: STRING</span> </span>
<span class="py-lineno">118</span>  <span class="py-line"><span class="py-docstring">        @param val: Shortcut Name</span> </span>
<span class="py-lineno">119</span>  <span class="py-line"><span class="py-docstring">        """</span> </span>
<span class="py-lineno">120</span>  <span class="py-line">        <span class="py-name">r</span> <span class="py-op">=</span> <span class="py-name">self</span><span class="py-op">.</span><span id="link-35" class="py-name"><a title="Libs.libregisters.GFlags.GetReferencebyName" class="py-name" href="#" onclick="doclink('link-35', 'GetReferencebyName', 'Method Libs.libregisters.GFlags.GetReferencebyName()=Libs.libregisters.GFlags-class.html#GetReferencebyName'); return false;">GetReferencebyName</a></span></span><span class="py-op">(</span> <span class="py-name">val</span> <span class="py-op">)</span> </span>
<span class="py-lineno">121</span>  <span class="py-line">        <span class="py-keyword">return</span> <span class="py-name">self</span><span class="py-op">.</span><span id="link-36" class="py-name"><a title="Libs.libregisters.GFlags.Set" class="py-name" href="#" onclick="doclink('link-36', 'Set', 'Method Libs.libregisters.GFlags.Set()=Libs.libregisters.GFlags-class.html#Set'); return false;">Set</a></span></span><span class="py-op">(</span> <span class="py-name">r</span><span class="py-op">[</span><span class="py-number">1</span><span class="py-op">]</span> <span class="py-op">)</span> </span>
</div><span class="py-lineno">122</span>  <span class="py-line">     </span>
<a name="GFlags.Set"></a><div id="GFlags.Set-def"><span class="py-lineno">123</span> <a class="py-toggle" href="#" id="GFlags.Set-toggle" onclick="toggle('GFlags.Set'); return false;">-</a><span class="py-line">    <span class="py-keyword">def</span> <a class="py-def-name" href="Libs.libregisters.GFlags-class.html#Set">Set</a><span class="py-op">(</span><span class="py-param">self</span><span class="py-op">,</span> <span class="py-param">val</span><span class="py-op">)</span><span class="py-op">:</span> </span>
</div><div id="GFlags.Set-collapsed" style="display:none;" pad="+++" indent="++++++++"></div><div id="GFlags.Set-expanded"><span class="py-lineno">124</span>  <span class="py-line">        <span class="py-docstring">"""</span> </span>
<span class="py-lineno">125</span>  <span class="py-line"><span class="py-docstring">        Set a Flag</span> </span>
<span class="py-lineno">126</span>  <span class="py-line"><span class="py-docstring">        </span> </span>
<span class="py-lineno">127</span>  <span class="py-line"><span class="py-docstring">        @type  val: DWORD</span> </span>
<span class="py-lineno">128</span>  <span class="py-line"><span class="py-docstring">        @param val: Value of the flag to set</span> </span>
<span class="py-lineno">129</span>  <span class="py-line"><span class="py-docstring">        """</span> </span>
<span class="py-lineno">130</span>  <span class="py-line">         </span>
<span class="py-lineno">131</span>  <span class="py-line">        <span class="py-keyword">try</span><span class="py-op">:</span> </span>
<span class="py-lineno">132</span>  <span class="py-line">            <span class="py-name">current</span> <span class="py-op">=</span> <span class="py-name">self</span><span class="py-op">.</span><span id="link-37" class="py-name"><a title="Libs.libregisters.GFlags._query" class="py-name" href="#" onclick="doclink('link-37', '_query', 'Method Libs.libregisters.GFlags._query()=Libs.libregisters.GFlags-class.html#_query'); return false;">_query</a></span></span><span class="py-op">(</span><span class="py-op">)</span> </span>
<span class="py-lineno">133</span>  <span class="py-line">        <span class="py-keyword">except</span> <span class="py-name">Exception</span><span class="py-op">:</span> </span>
<span class="py-lineno">134</span>  <span class="py-line">            <span class="py-comment"># Key is not created, set will automatically do it</span> </span>
<span class="py-lineno">135</span>  <span class="py-line"><span class="py-comment"></span>            <span class="py-name">current</span> <span class="py-op">=</span> <span class="py-number">0L</span> </span>
<span class="py-lineno">136</span>  <span class="py-line"> </span>
<span class="py-lineno">137</span>  <span class="py-line">        <span class="py-name">self</span><span class="py-op">.</span><span id="link-38" class="py-name"><a title="Libs.libregisters.GFlags._set" class="py-name" href="#" onclick="doclink('link-38', '_set', 'Method Libs.libregisters.GFlags._set()=Libs.libregisters.GFlags-class.html#_set'); return false;">_set</a></span></span><span class="py-op">(</span> <span class="py-name">current</span> <span class="py-op">|</span> <span class="py-name">val</span> <span class="py-op">)</span>  </span>
<span class="py-lineno">138</span>  <span class="py-line">         </span>
<span class="py-lineno">139</span>  <span class="py-line">        <span class="py-keyword">return</span> <span class="py-name">current</span> <span class="py-op">|</span> <span class="py-name">val</span> </span>
</div><span class="py-lineno">140</span>  <span class="py-line"> </span>
<a name="GFlags.UnSetbyName"></a><div id="GFlags.UnSetbyName-def"><span class="py-lineno">141</span> <a class="py-toggle" href="#" id="GFlags.UnSetbyName-toggle" onclick="toggle('GFlags.UnSetbyName'); return false;">-</a><span class="py-line">    <span class="py-keyword">def</span> <a class="py-def-name" href="Libs.libregisters.GFlags-class.html#UnSetbyName">UnSetbyName</a><span class="py-op">(</span><span class="py-param">self</span><span class="py-op">,</span> <span class="py-param">val</span><span class="py-op">)</span><span class="py-op">:</span>  </span>
</div><span class="py-lineno">142</span>  <span class="py-line">        <span class="py-docstring">"""</span> </span>
<span class="py-lineno">143</span>  <span class="py-line"><span class="py-docstring">        Unset a Flag by its shorcut name</span> </span>
<span class="py-lineno">144</span>  <span class="py-line"><span class="py-docstring">        </span> </span>
<span class="py-lineno">145</span>  <span class="py-line"><span class="py-docstring">        @type  val: STRING</span> </span>
<span class="py-lineno">146</span>  <span class="py-line"><span class="py-docstring">        @param val: Shortcut Name</span> </span>
<span class="py-lineno">147</span>  <span class="py-line"><span class="py-docstring">        """</span> </span>
<span class="py-lineno">148</span>  <span class="py-line">        <span class="py-name">r</span> <span class="py-op">=</span> <span class="py-name">self</span><span class="py-op">.</span><span id="link-39" class="py-name"><a title="Libs.libregisters.GFlags.GetReferencebyName" class="py-name" href="#" onclick="doclink('link-39', 'GetReferencebyName', 'Method Libs.libregisters.GFlags.GetReferencebyName()=Libs.libregisters.GFlags-class.html#GetReferencebyName'); return false;">GetReferencebyName</a></span></span><span class="py-op">(</span> <span class="py-name">val</span> <span class="py-op">)</span> </span>
<span class="py-lineno">149</span>  <span class="py-line">        <span class="py-keyword">return</span> <span class="py-name">self</span><span class="py-op">.</span><span id="link-40" class="py-name"><a title="Libs.libregisters.GFlags.UnSet" class="py-name" href="#" onclick="doclink('link-40', 'UnSet', 'Method Libs.libregisters.GFlags.UnSet()=Libs.libregisters.GFlags-class.html#UnSet'); return false;">UnSet</a></span></span><span class="py-op">(</span> <span class="py-name">r</span><span class="py-op">[</span><span class="py-number">1</span><span class="py-op">]</span> <span class="py-op">)</span> </span>
</div><span class="py-lineno">150</span>  <span class="py-line">         </span>
<a name="GFlags.UnSet"></a><div id="GFlags.UnSet-def"><span class="py-lineno">151</span> <a class="py-toggle" href="#" id="GFlags.UnSet-toggle" onclick="toggle('GFlags.UnSet'); return false;">-</a><span class="py-line">    <span class="py-keyword">def</span> <a class="py-def-name" href="Libs.libregisters.GFlags-class.html#UnSet">UnSet</a><span class="py-op">(</span><span class="py-param">self</span><span class="py-op">,</span> <span class="py-param">val</span><span class="py-op">)</span><span class="py-op">:</span> </span>
</div><div id="GFlags.UnSet-collapsed" style="display:none;" pad="+++" indent="++++++++"></div><div id="GFlags.UnSet-expanded"><span class="py-lineno">152</span>  <span class="py-line">        <span class="py-docstring">"""</span> </span>
<span class="py-lineno">153</span>  <span class="py-line"><span class="py-docstring">        Set a Flag</span> </span>
<span class="py-lineno">154</span>  <span class="py-line"><span class="py-docstring">        </span> </span>
<span class="py-lineno">155</span>  <span class="py-line"><span class="py-docstring">        @type  val: DWORD</span> </span>
<span class="py-lineno">156</span>  <span class="py-line"><span class="py-docstring">        @param val: Value of the flag to set</span> </span>
<span class="py-lineno">157</span>  <span class="py-line"><span class="py-docstring">        """</span> </span>
<span class="py-lineno">158</span>  <span class="py-line">         </span>
<span class="py-lineno">159</span>  <span class="py-line">        <span class="py-name">current</span> <span class="py-op">=</span> <span class="py-name">self</span><span class="py-op">.</span><span id="link-41" class="py-name"><a title="Libs.libregisters.GFlags._query" class="py-name" href="#" onclick="doclink('link-41', '_query', 'Method Libs.libregisters.GFlags._query()=Libs.libregisters.GFlags-class.html#_query'); return false;">_query</a></span></span><span class="py-op">(</span><span class="py-op">)</span> </span>
<span class="py-lineno">160</span>  <span class="py-line">        <span class="py-name">self</span><span class="py-op">.</span><span id="link-42" class="py-name"><a title="Libs.libregisters.GFlags._set" class="py-name" href="#" onclick="doclink('link-42', '_set', 'Method Libs.libregisters.GFlags._set()=Libs.libregisters.GFlags-class.html#_set'); return false;">_set</a></span></span><span class="py-op">(</span> <span class="py-name">current</span> <span class="py-op">&amp;</span><span class="py-op">~</span> <span class="py-name">val</span> <span class="py-op">)</span> </span>
<span class="py-lineno">161</span>  <span class="py-line">         </span>
<span class="py-lineno">162</span>  <span class="py-line">        <span class="py-keyword">return</span> <span class="py-name">current</span> <span class="py-op">&amp;</span><span class="py-op">~</span> <span class="py-name">val</span>  </span>
</div><span class="py-lineno">163</span>  <span class="py-line"> </span>
<a name="GFlags.isSet"></a><div id="GFlags.isSet-def"><span class="py-lineno">164</span> <a class="py-toggle" href="#" id="GFlags.isSet-toggle" onclick="toggle('GFlags.isSet'); return false;">-</a><span class="py-line">    <span class="py-keyword">def</span> <a class="py-def-name" href="Libs.libregisters.GFlags-class.html#isSet">isSet</a><span class="py-op">(</span><span class="py-param">self</span><span class="py-op">,</span> <span class="py-param">val</span><span class="py-op">)</span><span class="py-op">:</span> </span>
</div><div id="GFlags.isSet-collapsed" style="display:none;" pad="+++" indent="++++++++"></div><div id="GFlags.isSet-expanded"><span class="py-lineno">165</span>  <span class="py-line">        <span class="py-docstring">"""</span> </span>
<span class="py-lineno">166</span>  <span class="py-line"><span class="py-docstring">        Whether a Flag is set</span> </span>
<span class="py-lineno">167</span>  <span class="py-line"><span class="py-docstring">        </span> </span>
<span class="py-lineno">168</span>  <span class="py-line"><span class="py-docstring">        @type  val: STRING</span> </span>
<span class="py-lineno">169</span>  <span class="py-line"><span class="py-docstring">        @param val: Shortcut name</span> </span>
<span class="py-lineno">170</span>  <span class="py-line"><span class="py-docstring">        """</span> </span>
<span class="py-lineno">171</span>  <span class="py-line"> </span>
<span class="py-lineno">172</span>  <span class="py-line">        <span class="py-name">r</span> <span class="py-op">=</span> <span class="py-name">self</span><span class="py-op">.</span><span id="link-43" class="py-name"><a title="Libs.libregisters.GFlags.GetReferencebyName" class="py-name" href="#" onclick="doclink('link-43', 'GetReferencebyName', 'Method Libs.libregisters.GFlags.GetReferencebyName()=Libs.libregisters.GFlags-class.html#GetReferencebyName'); return false;">GetReferencebyName</a></span></span><span class="py-op">(</span> <span class="py-name">val</span> <span class="py-op">)</span> </span>
<span class="py-lineno">173</span>  <span class="py-line">        <span class="py-name">current</span> <span class="py-op">=</span> <span class="py-name">self</span><span class="py-op">.</span><span id="link-44" class="py-name"><a title="Libs.libregisters.GFlags._query" class="py-name" href="#" onclick="doclink('link-44', '_query', 'Method Libs.libregisters.GFlags._query()=Libs.libregisters.GFlags-class.html#_query'); return false;">_query</a></span></span><span class="py-op">(</span><span class="py-op">)</span> </span>
<span class="py-lineno">174</span>  <span class="py-line">         </span>
<span class="py-lineno">175</span>  <span class="py-line">        <span class="py-keyword">return</span> <span class="py-name">bool</span><span class="py-op">(</span> <span class="py-name">r</span><span class="py-op">[</span><span class="py-number">1</span><span class="py-op">]</span> <span class="py-op">&amp;</span> <span class="py-name">current</span> <span class="py-op">)</span> </span>
</div><span class="py-lineno">176</span>  <span class="py-line">         </span>
<a name="GFlags.Print"></a><div id="GFlags.Print-def"><span class="py-lineno">177</span> <a class="py-toggle" href="#" id="GFlags.Print-toggle" onclick="toggle('GFlags.Print'); return false;">-</a><span class="py-line">    <span class="py-keyword">def</span> <a class="py-def-name" href="Libs.libregisters.GFlags-class.html#Print">Print</a><span class="py-op">(</span><span class="py-param">self</span><span class="py-op">)</span><span class="py-op">:</span> </span>
</div><div id="GFlags.Print-collapsed" style="display:none;" pad="+++" indent="++++++++"></div><div id="GFlags.Print-expanded"><span class="py-lineno">178</span>  <span class="py-line">        <span class="py-docstring">"""</span> </span>
<span class="py-lineno">179</span>  <span class="py-line"><span class="py-docstring">        Print all the current setted GFlags </span> </span>
<span class="py-lineno">180</span>  <span class="py-line"><span class="py-docstring">        </span> </span>
<span class="py-lineno">181</span>  <span class="py-line"><span class="py-docstring">        @rtype:  LIST OF TUPLES</span> </span>
<span class="py-lineno">182</span>  <span class="py-line"><span class="py-docstring">        @return: A list of a tuple with two elements: Shortcut Name and flag information</span> </span>
<span class="py-lineno">183</span>  <span class="py-line"><span class="py-docstring">        """</span> </span>
<span class="py-lineno">184</span>  <span class="py-line">        <span class="py-name">current</span> <span class="py-op">=</span> <span class="py-name">self</span><span class="py-op">.</span><span id="link-45" class="py-name"><a title="Libs.libregisters.GFlags._query" class="py-name" href="#" onclick="doclink('link-45', '_query', 'Method Libs.libregisters.GFlags._query()=Libs.libregisters.GFlags-class.html#_query'); return false;">_query</a></span></span><span class="py-op">(</span><span class="py-op">)</span> </span>
<span class="py-lineno">185</span>  <span class="py-line">        <span class="py-name">ret</span> <span class="py-op">=</span> <span class="py-op">[</span><span class="py-op">]</span> </span>
<span class="py-lineno">186</span>  <span class="py-line">        <span class="py-keyword">for</span> <span class="py-name">a</span> <span class="py-keyword">in</span> <span id="link-46" class="py-name"><a title="Libs.libregisters.GFlagsRef" class="py-name" href="#" onclick="doclink('link-46', 'GFlagsRef', 'Variable Libs.libregisters.GFlagsRef=Libs.libregisters-module.html#GFlagsRef'); return false;">GFlagsRef</a></span></span><span class="py-op">.</span><span class="py-name">keys</span><span class="py-op">(</span><span class="py-op">)</span><span class="py-op">:</span> </span>
<span class="py-lineno">187</span>  <span class="py-line">            <span class="py-name">r</span> <span class="py-op">=</span> <span id="link-47" class="py-name"><a title="Libs.libregisters.GFlagsRef" class="py-name" href="#" onclick="doclink('link-47', 'GFlagsRef', 'Variable Libs.libregisters.GFlagsRef=Libs.libregisters-module.html#GFlagsRef'); return false;">GFlagsRef</a></span></span><span class="py-op">[</span><span class="py-name">a</span><span class="py-op">]</span> </span>
<span class="py-lineno">188</span>  <span class="py-line">            <span class="py-keyword">if</span> <span class="py-name">r</span><span class="py-op">[</span><span class="py-number">1</span><span class="py-op">]</span> <span class="py-op">&amp;</span> <span class="py-name">current</span><span class="py-op">:</span> </span>
<span class="py-lineno">189</span>  <span class="py-line">                <span class="py-name">ret</span><span class="py-op">.</span><span id="link-48" class="py-name"><a title="Libs.libheap.PLook.append" class="py-name" href="#" onclick="doclink('link-48', 'append', 'Method Libs.libheap.PLook.append()=Libs.libheap.PLook-class.html#append'); return false;">append</a></span></span> <span class="py-op">(</span> <span class="py-op">(</span><span class="py-name">a</span><span class="py-op">,</span> <span class="py-name">r</span><span class="py-op">)</span> <span class="py-op">)</span> </span>
<span class="py-lineno">190</span>  <span class="py-line">        <span class="py-keyword">return</span> <span class="py-name">ret</span> </span>
</div><span class="py-lineno">191</span>  <span class="py-line">     </span>
<a name="GFlags.Clear"></a><div id="GFlags.Clear-def"><span class="py-lineno">192</span> <a class="py-toggle" href="#" id="GFlags.Clear-toggle" onclick="toggle('GFlags.Clear'); return false;">-</a><span class="py-line">    <span class="py-keyword">def</span> <a class="py-def-name" href="Libs.libregisters.GFlags-class.html#Clear">Clear</a><span class="py-op">(</span><span class="py-param">self</span><span class="py-op">)</span><span class="py-op">:</span> </span>
</div><div id="GFlags.Clear-collapsed" style="display:none;" pad="+++" indent="++++++++"></div><div id="GFlags.Clear-expanded"><span class="py-lineno">193</span>  <span class="py-line">        <span class="py-docstring">"""</span> </span>
<span class="py-lineno">194</span>  <span class="py-line"><span class="py-docstring">        Clear the Flags</span> </span>
<span class="py-lineno">195</span>  <span class="py-line"><span class="py-docstring">        """</span> </span>
<span class="py-lineno">196</span>  <span class="py-line">        <span class="py-keyword">if</span> <span class="py-name">self</span><span class="py-op">.</span><span class="py-name">processname</span><span class="py-op">:</span> </span>
<span class="py-lineno">197</span>  <span class="py-line">            <span class="py-name">_winreg</span><span class="py-op">.</span><span class="py-name">DeleteKey</span><span class="py-op">(</span><span class="py-name">_winreg</span><span class="py-op">.</span><span class="py-name">HKEY_LOCAL_MACHINE</span><span class="py-op">,</span> <span class="py-name">self</span><span class="py-op">.</span><span class="py-name">subkey</span><span class="py-op">)</span> </span>
<span class="py-lineno">198</span>  <span class="py-line">        <span class="py-keyword">else</span><span class="py-op">:</span> </span>
<span class="py-lineno">199</span>  <span class="py-line">            <span class="py-name">self</span><span class="py-op">.</span><span id="link-49" class="py-name"><a title="Libs.libregisters.GFlags._set" class="py-name" href="#" onclick="doclink('link-49', '_set', 'Method Libs.libregisters.GFlags._set()=Libs.libregisters.GFlags-class.html#_set'); return false;">_set</a></span></span><span class="py-op">(</span> <span class="py-number">0</span> <span class="py-op">)</span> </span>
</div><span class="py-lineno">200</span>  <span class="py-line">             </span>
<a name="GFlags._set"></a><div id="GFlags._set-def"><span class="py-lineno">201</span> <a class="py-toggle" href="#" id="GFlags._set-toggle" onclick="toggle('GFlags._set'); return false;">-</a><span class="py-line">    <span class="py-keyword">def</span> <a class="py-def-name" href="Libs.libregisters.GFlags-class.html#_set">_set</a><span class="py-op">(</span><span class="py-param">self</span><span class="py-op">,</span> <span class="py-param">flag</span><span class="py-op">)</span><span class="py-op">:</span> </span>
</div><div id="GFlags._set-collapsed" style="display:none;" pad="+++" indent="++++++++"></div><div id="GFlags._set-expanded"><span class="py-lineno">202</span>  <span class="py-line">        <span class="py-keyword">try</span><span class="py-op">:</span> </span>
<span class="py-lineno">203</span>  <span class="py-line">            <span class="py-name">hkey</span> <span class="py-op">=</span> <span class="py-name">_winreg</span><span class="py-op">.</span><span class="py-name">OpenKey</span><span class="py-op">(</span><span class="py-name">_winreg</span><span class="py-op">.</span><span class="py-name">HKEY_LOCAL_MACHINE</span><span class="py-op">,</span> <span class="py-name">self</span><span class="py-op">.</span><span class="py-name">subkey</span><span class="py-op">,</span> <span class="py-number">0</span><span class="py-op">,</span> <span class="py-name">_winreg</span><span class="py-op">.</span><span class="py-name">KEY_SET_VALUE</span> <span class="py-op">)</span> </span>
<span class="py-lineno">204</span>  <span class="py-line">        <span class="py-keyword">except</span> <span class="py-name">WindowsError</span><span class="py-op">:</span> </span>
<span class="py-lineno">205</span>  <span class="py-line">            <span class="py-keyword">try</span><span class="py-op">:</span> </span>
<span class="py-lineno">206</span>  <span class="py-line">                <span class="py-name">hkey</span> <span class="py-op">=</span> <span class="py-name">_winreg</span><span class="py-op">.</span><span class="py-name">CreateKey</span><span class="py-op">(</span><span class="py-name">_winreg</span><span class="py-op">.</span><span class="py-name">HKEY_LOCAL_MACHINE</span><span class="py-op">,</span> <span class="py-name">self</span><span class="py-op">.</span><span class="py-name">subkey</span><span class="py-op">)</span> </span>
<span class="py-lineno">207</span>  <span class="py-line">            <span class="py-keyword">except</span> <span class="py-name">WindowsError</span><span class="py-op">:</span> </span>
<span class="py-lineno">208</span>  <span class="py-line">                <span class="py-keyword">raise</span> <span class="py-name">Exception</span><span class="py-op">,</span> <span class="py-string">"Cannot Open/Create key (%s)"</span> <span class="py-op">%</span> <span class="py-name">self</span><span class="py-op">.</span><span class="py-name">subkey</span> </span>
<span class="py-lineno">209</span>  <span class="py-line">             </span>
<span class="py-lineno">210</span>  <span class="py-line">        <span class="py-keyword">try</span><span class="py-op">:</span> </span>
<span class="py-lineno">211</span>  <span class="py-line">            <span class="py-name">_winreg</span><span class="py-op">.</span><span class="py-name">SetValueEx</span><span class="py-op">(</span><span class="py-name">hkey</span><span class="py-op">,</span> <span class="py-string">"GlobalFlag"</span><span class="py-op">,</span> <span class="py-number">0</span><span class="py-op">,</span> <span class="py-name">_winreg</span><span class="py-op">.</span><span class="py-name">REG_DWORD</span><span class="py-op">,</span> <span class="py-name">int</span><span class="py-op">(</span><span class="py-name">flag</span><span class="py-op">)</span> <span class="py-op">)</span> </span>
<span class="py-lineno">212</span>  <span class="py-line">        <span class="py-keyword">except</span> <span class="py-name">WindowsError</span><span class="py-op">:</span> </span>
<span class="py-lineno">213</span>  <span class="py-line">            <span class="py-keyword">raise</span> <span class="py-name">Exception</span><span class="py-op">,</span> <span class="py-string">"Cannot SetValue key (%s\\%s)"</span> <span class="py-op">%</span> <span class="py-op">(</span> <span class="py-name">self</span><span class="py-op">.</span><span class="py-name">subkey</span><span class="py-op">,</span> <span class="py-string">"GlobalFlag"</span><span class="py-op">)</span> </span>
<span class="py-lineno">214</span>  <span class="py-line">        <span class="py-keyword">except</span> <span class="py-name">ValueError</span><span class="py-op">:</span> </span>
<span class="py-lineno">215</span>  <span class="py-line">            <span class="py-keyword">raise</span> <span class="py-name">Exception</span><span class="py-op">,</span> <span class="py-string">"Cannot SetValue key  (%s\\%s) %s %s"</span> <span class="py-op">%</span> <span class="py-op">(</span> <span class="py-name">self</span><span class="py-op">.</span><span class="py-name">subkey</span><span class="py-op">,</span> <span class="py-string">"GlobalFlag"</span><span class="py-op">,</span> <span class="py-name">str</span><span class="py-op">(</span><span class="py-name">flag</span><span class="py-op">)</span><span class="py-op">,</span> <span class="py-name">type</span><span class="py-op">(</span><span class="py-name">flag</span><span class="py-op">)</span><span class="py-op">)</span> </span>
<span class="py-lineno">216</span>  <span class="py-line">         </span>
<span class="py-lineno">217</span>  <span class="py-line">        <span class="py-keyword">try</span><span class="py-op">:</span> </span>
<span class="py-lineno">218</span>  <span class="py-line">            <span class="py-name">_winreg</span><span class="py-op">.</span><span class="py-name">CloseKey</span><span class="py-op">(</span><span class="py-name">hkey</span><span class="py-op">)</span> </span>
<span class="py-lineno">219</span>  <span class="py-line">        <span class="py-keyword">except</span> <span class="py-name">WindowsError</span><span class="py-op">:</span> </span>
<span class="py-lineno">220</span>  <span class="py-line">            <span class="py-keyword">raise</span> <span class="py-name">Exception</span><span class="py-op">,</span> <span class="py-string">"Cannot Close key (%s)"</span> <span class="py-op">%</span> <span class="py-name">self</span><span class="py-op">.</span><span class="py-name">subkey</span> </span>
</div></div><span class="py-lineno">221</span>  <span class="py-line">         </span>
<span class="py-lineno">222</span>  <span class="py-line"><span class="py-keyword">if</span> <span class="py-name">__name__</span> <span class="py-op">==</span> <span class="py-string">"__main__"</span><span class="py-op">:</span> </span>
<span class="py-lineno">223</span>  <span class="py-line">    <span id="link-50" class="py-name"><a title="Libs.libregisters.g" class="py-name" href="#" onclick="doclink('link-50', 'g', 'Variable Libs.libregisters.g=Libs.libregisters-module.html#g'); return false;">g</a></span></span> <span class="py-op">=</span> <span id="link-51" class="py-name"><a title="Libs.libregisters.GFlags" class="py-name" href="#" onclick="doclink('link-51', 'GFlags', 'Class Libs.libregisters.GFlags=Libs.libregisters.GFlags-class.html'); return false;">GFlags</a></span></span><span class="py-op">(</span><span class="py-string">"notepad.exe"</span><span class="py-op">)</span> </span>
<span class="py-lineno">224</span>  <span class="py-line">    <span id="link-52" class="py-name"><a title="Libs.libregisters.g" class="py-name" href="#" onclick="doclink('link-52', 'g', 'Variable Libs.libregisters.g=Libs.libregisters-module.html#g'); return false;">g</a></span></span><span class="py-op">.</span><span id="link-53" class="py-name"><a title="Libs.libregisters.GFlags.Set" class="py-name" href="#" onclick="doclink('link-53', 'Set', 'Method Libs.libregisters.GFlags.Set()=Libs.libregisters.GFlags-class.html#Set'); return false;">Set</a></span></span><span class="py-op">(</span> <span class="py-string">'htc'</span> <span class="py-op">)</span> </span>
<span class="py-lineno">225</span>  <span class="py-line">    <span id="link-54" class="py-name"><a title="Libs.libregisters.g" class="py-name" href="#" onclick="doclink('link-54', 'g', 'Variable Libs.libregisters.g=Libs.libregisters-module.html#g'); return false;">g</a></span></span><span class="py-op">.</span><span id="link-55" class="py-name"><a title="Libs.libhook.FastLogHook.Clear
Libs.libregisters.GFlags.Clear" class="py-name" href="#" onclick="doclink('link-55', 'Clear', 'Method Libs.libhook.FastLogHook.Clear()=Libs.libhook.FastLogHook-class.html#Clear,Method Libs.libregisters.GFlags.Clear()=Libs.libregisters.GFlags-class.html#Clear'); return false;">Clear</a></span></span><span class="py-op">(</span><span class="py-op">)</span> </span>
<span class="py-lineno">226</span>  <span class="py-line"> </span><script type="text/javascript">
<!--
expandto(location.href);
// -->
</script>
</pre>
<br />
<!-- ==================== NAVIGATION BAR ==================== -->
<table class="navbar" border="0" width="100%" cellpadding="0"
       bgcolor="#a0c0ff" cellspacing="0">
  <tr valign="middle">

  <!-- Tree link -->
      <th>&nbsp;&nbsp;&nbsp;<a
        href="module-tree.html">Trees</a>&nbsp;&nbsp;&nbsp;</th>

  <!-- Index link -->
      <th>&nbsp;&nbsp;&nbsp;<a
        href="identifier-index.html">Indices</a>&nbsp;&nbsp;&nbsp;</th>

  <!-- Help link -->
      <th>&nbsp;&nbsp;&nbsp;<a
        href="help.html">Help</a>&nbsp;&nbsp;&nbsp;</th>

  <!-- Project homepage -->
      <th class="navbar" align="right" width="100%">
        <table border="0" cellpadding="0" cellspacing="0">
          <tr><th class="navbar" align="center"
            >Immunity Debugger API Reference</th>
          </tr></table></th>
  </tr>
</table>
<table border="0" cellpadding="0" cellspacing="0" width="100%%">
  <tr>
    <td align="left" class="footer">Generated by Epydoc
        3.0alpha3 on Thu May 29 13:03:13 2008</td>
    <td align="right" class="footer">
      <a href="http://epydoc.sourceforge.net">http://epydoc.sourceforge.net</a>
    </td>
  </tr>
</table>

<script type="text/javascript">
  <!--
  // Private objects are initially displayed (because if
  // javascript is turned off then we want them to be
  // visible); but by default, we want to hide them.  So hide
  // them unless we have a cookie that says to show them.
  checkCookie()
  // -->
</script>
  
</body>
</html>
